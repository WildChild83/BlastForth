( ---------------------------------------------------------------------------- )
( **************************************************************************** )
(       Sound Hardware Drivers                                                 )
( **************************************************************************** )
( ---------------------------------------------------------------------------- )

( ---------------------------------------------------------------------------- )
(                                                                              )
(       Dependencies:                                                          )
(           - glossary.fs                                                      )
(           - romfile.fs                                                       )
(                                                                              )
( ---------------------------------------------------------------------------- )
Forth definitions   

$A00000 constant z80ram
$A11100 constant z80request     aka z80status
$A11200 constant z80reset

( ---------------------------------------------------------------------------- )
code z80[[ ( -- ) z80reset [#] a1 address, 0 # [a1] h move,
                  $100 # [a1 -256 +] h move, $100 # [a1] h move, next
code ]]z80 ( -- ) z80reset [#] a1 address, 0 # [a1] h move, d1 20 for loop
                  $100 # [a1] h move, 0 # [a1 -256 +] h move, next
code z80[  ( -- ) z80request [#] a1 address, $100 # [a1] h move,
                  begin 0 # [a1] test-bit, z= until next
code ]z80  ( -- ) 0 # z80request [#] h move, next

: move>z80    ( addr u -- ) z80ram  swap z80[[ cmove ]]z80 ;
: move>z80-at ( addr u z80addr -- ) swap z80[  cmove  ]z80 ;

: z80! ( c z80addr -- ) z80[ c! ]z80 ;
: z80@ ( z80addr -- c ) z80[ c@ ]z80 ;

{:} sound-driver: ( addr u "name" -- )
    create h, ,  does> ( -- ) dup half+ @ swap h@ move>z80 ;

( ---------------------------------------------------------------------------- )
Glossary Z80 definitions {

include z80.fs


( ---------------------------------------------------------------------------- )
( ---------------------------------------------------------------------------- )
( ---------------------------------------------------------------------------- )
( ---------------------------------------------------------------------------- )
( ---------------------------------------------------------------------------- )
( ---------------------------------------------------------------------------- )
( ---------------------------------------------------------------------------- )















